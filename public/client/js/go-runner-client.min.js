/*
* goRunner v.0.0.1
* (c) 2014, Obogo
* License: Obogo 2014. All Rights Reserved.
*/
!function(a){function b(a,b,c){function d(a,b){var c,d;d=h[a],d&&(b?(c=d.indexOf(b),-1!==c&&d.splice(c,1)):d.length=0)}function e(a,b){return h[a]=h[a]||[],h[a].push(b),function(){d(a,b)}}function f(b,c){return b&&b.apply(a,c)}function g(a){if(h[a])for(var b=0,c=h[a],d=c.length;d>b;)f(c[b],arguments),b+=1}var h={};b&&c?(a.on=b[c.on]&&b[c.on].bind(b),a.off=b[c.off]&&b[c.off].bind(b),a.dispatch=b[c.dispatch].bind(b)):(a.on=e,a.off=d,a.dispatch=g)}function c(a){var b=[],c=0,d=a.length;if(void 0!==a.length)for(;d>c;)b.push(a[c]),c+=1;else for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b}function d(a,b){var c,d,e,f,g;for(b||(b=function(a,b){return a>b?1:b>a?-1:0}),d=a.length,f=d-1,c=0;d>c;c+=1)for(e=0;f>e;e+=1)b(a[e],a[e+1])>0&&(g=a[e+1],a[e+1]=a[e],a[e]=g);return a}function e(b,c){var d,e,f,g=0;if(arguments.length>2&&(f=a.util.array.toArray(arguments),f.splice(0,2)),b&&b.length)for(d=b.length;d>g;){if(e=c.apply(null,[b[g],g,b].concat(f)),void 0!==e)return e;g+=1}else if(!(b instanceof Array))for(g in b)if(b.hasOwnProperty(g)&&(e=c.apply(null,[b[g],g,b].concat(f)),void 0!==e))return e;return b}function f(b,c,d,e){console.log("	step %s",b.label),e=e||"";var g,h,i,j=(e?e+".":"")+(void 0!==c?c:"R"),k={};if(k.uid=j,k.index=c,i=b.children,a.extend(k,t[p.STEP],t[b.type]||{},b),d&&(d[c]=k),i&&i.length)for(g=0,h=k.children.length,k.children=[];h>g;)f(i[g],g,k.children,j),g+=1;else k.children=[];return d?void 0:k}function g(a,b){return h(a,null,null,null,b?v:u)}function h(b,c,d,e,f){var g,i,j={};g=t[b.type];for(i in b)f[i]||("children"===i?(j[i]={length:b.children.length},a.each(b.children,h,j[i],f)):b.hasOwnProperty(i)&&g[i]!==b[i]&&(j[i]=b[i]));return e?void(e[c]=j):j}function i(a){this.dispatcher=a}function j(){function b(a){F=G=a}function c(b){var c=G;a.each(b,function(a){o.log(c,"%s.childIndex = %s",c.label,a),a=parseInt(a,10),c.childIndex=a,c=c[K][a],J.push(a),F=c,F.state=r.ENTERING}),o.log(c,"values %s",J.join("."))}function d(a){return a?J.slice(0,a):J}function e(){return F}function f(){return J.length}function g(){return F||(i(G),o.log("	%cRoot Start: %s","color:#F90",F.label)),j()||l()||k()?void(F.status===q.SKIP&&g()):F===G?void o.log(F,"%cROOT: %s","color:#F90",F.label):void g()}function h(a){var b=a.uid.split("."),c=0,d=b.length-1;for(b.shift();d>c;)b[c]=parseInt(b[c],10),c+=1;return b}function i(a){var b,c=h(a),d=0,e=c.length;for(b=m(c,0,G,-1),b&&(b.childIndex=c[e-1]||0),J.length=0;e>d;)J[d]=c[d],d+=1;F=a,F.state=r.ENTERING}function j(){var a=F.children.length;return F.status===q.SKIP||F.childIndex>=a?!1:a&&F.childIndex+1<a?(i(F.children[F.childIndex+1]),o.log(F,"%cgetNextChild: %s","color:#F90",F.label),!0):(F.childrenComplete=!0,!1)}function k(){var a=m(J,0,G,-1);return a?(i(a),o.log(F,"%cgetParent: %s","color:#F90",F.label),!0):!1}function l(){var a,b=J.length-1;return J[b]+=1,a=m(J,0,G,0),a?(i(a),o.log(F,"%cgetNextSibling: %s","color:#F90",F.label),!0):k()}function m(a,b,c,d){c=c||G,b=b||0,d=d||0;var e=a[b];return b>=a.length+d?c:void 0!==e&&c.children[e]?(c=c.children[e],m(a,b+1,c,d)):null}function n(a){var b=h(a);return b.length?m(b,0,G,-1):G}function s(){var a=[];return t(G,null,null,a),a}function t(b,c,d,e){b.status===q.SKIP&&a.each(b.children,B),a.each(b.children,t,e),x(b,e)}function u(a){return a.status===q.PASS?1:a.time>a.maxTime?1:a.time/a.maxTime}function v(a,b){if(b=b||H&&H.slice()||[],a=a||e()){H&&(H=null),x(a,b);var c=n(a);return c&&c!==a&&v(c,b),b}}function w(a){H=v(a)}function x(a,b){var c,d,e=0;if(a.status===q.SKIP)return void(a.progress=0);if(a.state===r.COMPLETE)a.progress=1;else if(c=a.children.length,c&&-1!==a.childIndex){for(d=0,a.skipCount=0;e<=a.childIndex&&c>e;)a.children[e].status!=q.SKIP?d+=a.children[e].progress:a.skipCount+=1,e+=1;d+=u(a),a.progress=d/(c-a.skipCount+(a.type!==p.ROOT?1:0))}else a.progress=u(a);b.push(a)}function y(){if(F.type===p.IF||F.type===p.ELSEIF||F.type===p.ELSE){var a=m(J,0,G,-1);(F.type===p.ELSEIF||F.type===p.ELSE)&&z(a),(F.type===p.IF||F.type===p.ELSEIF)&&A(a)}}function z(a){for(var b=a.childIndex-1,c=0;b>=c;){var d=a.children[b];if(d.type!==p.IF&&d.type!==p.ELSEIF)break;B(d),b-=1}}function A(a){for(var b=a.childIndex+1,c=a.children.length;c>b;){var d=a.children[b];if(d.type!==p.ELSEIF&&d.type!==p.ELSE)break;B(d),b+=1}}function B(a){a.status!==q.SKIP&&(o.log(a,"%cSKIP %s","color:#FF6600",a.uid),a.status=q.SKIP,w(a))}function C(a){return a.type===p.IF||a.type===p.ELSEIF||a.type===p.ELSE}function D(){var a=E(G),b=a.complete?a.time/a.complete:0,c=a.total*b;return a.totalTime>c&&(c=a.totalTime),Math.ceil(.001*(c-a.time))}function E(a){for(var b,c=0,d=0,e=0,f=0,g=0,h=a.children.length;h>g;)a.children.length&&(b=E(a.children[g]),c+=b.complete,d+=b.total,e+=b.time,f+=b.totalTime),c+=a.state===r.COMPLETE?1:0,d+=1,e+=a.time,f+=a.time||2*a.increment,g+=1;return{complete:c,total:d,time:e,totalTime:f}}var F,G,H,I,J=[],K="children";this.setData=b,this.setPath=c,this.getDepth=f,this.next=function(){return I=e(),g()},this.getLastStep=function(){return I},this.getSelected=e,this.getPath=d,this.getProgressChanges=v,this.getAllProgress=s,this.skipBlock=y,this.isCondition=C,this.getTime=D}function k(b,c,d,e){function f(a){var b=Date.now(),c=m+e;clearTimeout(k),a&&(console.log("%c%s","color:#009900;",a),j=a),b>c?(m=b,h()):k=setTimeout(f,c-b)}function h(){var e,f,h=d.getPath().join(".");c.activePath="R"+(h&&"."+h||""),d.getProgressChanges(),e=g(c),f=a.data.diff(i,e),i=e,b.dispatch(j,f)}var i,j,k,l={},m=0;return e=e||0,l.throttle=e,l.fire=f,l}function l(c){function d(){return I.children}function e(a){D=a,h()}function h(){n(),l(D),I.timeLeft=G.getTime(),B(s.RESET)}function l(b){var c=a.each(b.slice(),f,E);I.children=c,o.log(I,""),G.setData(I)}function m(a){H.async||(C=1),G.setPath(a?"string"==typeof a?a.split("."):a:[0]),o.log(G.getSelected(),"start %s",G.getSelected().label),B(s.START),u()}function n(){C&&(clearTimeout(C),C=0,B(s.STOP))}function t(){activeStep?(activeStep.time=0,v()):m()}function u(){H.async?(clearTimeout(C),C=setTimeout(v,G.getSelected().increment)):v()}function v(){var a=G.getSelected();o.log(a,"run %s state:%s",a.label,a.state),G.isCondition(a)?a.status===q.SKIP?(a.progress=0,w()):a.state===r.COMPLETE?w():a.status!==q.PASS?x(a):a.children.length&&a.childIndex<a.children.length-1?w():a.time<a.maxTime?(a.state=r.COMPLETE,y(a)):z(a):a.children.length&&-1===a.childIndex?G.next():a.state===r.COMPLETE?y(a):a.time<a.maxTime?x(a):z(a),C&&(B(s.UPDATE),u())}function w(){G.next(),B()}function x(a){a.state=r.RUNNING,o.log(a,"run method %s",a.type),a.status=F[a.type](a),A(a),a.status===q.PASS?(a.state=r.COMPLETE,G.skipBlock(),o.log(a,"pass %s",a.label),a.type===p.ROOT&&(c.stop(),B(s.DONE))):a.time>a.maxTime&&z(a)}function y(a){return a.endTime=Date.now(),A(a),o.log(a,"complete %s",a.label),a.type===p.ROOT?void c.stop():void w()}function z(a){o.log(G.getSelected(),"run expired"),A(a),o.log(G.getSelected(),"expired %s %s/%s",a.label,a.time,a.maxTime),a.status=G.isCondition(a)?q.SKIP:q.TIMED_OUT,a.state=r.COMPLETE}function A(a){a.startTime||(a.startTime=Date.now()),a.time=Date.now()-a.startTime,o.log(G.getSelected(),"updateTime %s %s/%s",a.label,a.time,a.maxTime)}function B(a){J.fire(a)}b(c);var C,D,E="R",F=new i(c),G=new j,H={async:!0},I=f({uid:E,label:p.ROOT,type:p.ROOT,children:[],index:-1,maxTime:100}),J=k(c,I,G,1e3);return c.types=p,c.start=m,c.stop=n,c.resume=t,c.reset=h,c.getSteps=d,c.setSteps=e,c.getRoot=function(){return g(I)},c.getCurrentStep=function(){return G.getSelected()},c.getLastStep=function(){return G.getLastStep()},c}var m=a.runner=a.runner||{};m.events={START:"runner:start",STOP:"runner:stop",UPDATE:"runner:update",RESET:"runner:reset",DONE:"runner:done",START_RECORDING:"runner:startRecording",STOP_RECORDING:"runner:stopRecording"},a.util=a.util||{},a.util.array=a.util.array||{},a.util.array.toArray=c,a.util.array.sort=d,a.each=e,a.extend=function(b){for(var c,d,e=a.util.array.toArray(arguments),f=1,g=e.length;g>f;){c=e[f];for(d in c)b[d]=b[d]&&"object"==typeof b[d]?a.extend(b[d],c[d]):c[d];f+=1}return b};var n;!function(){function a(){return c.pop()||[]}function b(a){a.length=0,c.length<d&&c.push(a)}var c=[],d=40;if(window._)n=window._;else{Array.prototype.isArray=!0,n={},n.extend=function(a,b){a=a||{};for(var c in b)b.hasOwnProperty(c)&&(a[c]="object"==typeof b[c]?n.extend(a[c],b[c]):b[c]);return a},n.isString=function(a){return"string"==typeof a},n.isBoolean=function(a){return"boolean"==typeof a},n.isNumber=function(a){return"number"==typeof a},n.isArray=function(a){return a?!!a.isArray:!1},n.isEmpty=function(a){if(n.isString(a))return""===a;if(n.isArray(a))return 0===a.length;if(n.isObject(a)){for(var b in a)return!1;return!0}return!1},n.isUndefined=function(a){return"undefined"==typeof a},n.isFunction=function(a){return"function"==typeof a},n.isObject=function(a){return"object"==typeof a},n.isDate=function(a){return a instanceof Date};var e={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},f="[object Arguments]",g="[object Array]",h="[object Boolean]",i="[object Date]",j="[object Number]",k="[object Object]",l="[object RegExp]",m="[object String]";n.isEqual=function o(c,d,n,p,q,r){if(n){var s=n(c,d);if("undefined"!=typeof s)return!!s}if(c===d)return 0!==c||1/c==1/d;var t=typeof c,u=typeof d;if(!(c!==c||c&&e[t]||d&&e[u]))return!1;if(null==c||null==d)return c===d;var v=toString.call(c),w=toString.call(d);if(v==f&&(v=k),w==f&&(w=k),v!=w)return!1;switch(v){case h:case i:return+c==+d;case j:return c!=+c?d!=+d:0==c?1/c==1/d:c==+d;case l:case m:return c==String(d)}var x=v==g;if(!x){var y=hasOwnProperty.call(c,"__wrapped__"),z=hasOwnProperty.call(d,"__wrapped__");if(y||z)return o(y?c.__wrapped__:c,z?d.__wrapped__:d,n,p,q,r);if(v!=k)return!1;var A=c.constructor,B=d.constructor;if(A!=B&&!(isFunction(A)&&A instanceof A&&isFunction(B)&&B instanceof B)&&"constructor"in c&&"constructor"in d)return!1}var C=!q;q||(q=a()),r||(r=a());for(var D=q.length;D--;)if(q[D]==c)return r[D]==d;var E=0;if(s=!0,q.push(c),r.push(d),x){if(D=c.length,E=d.length,s=E==D,s||p)for(;E--;){var F=D,G=d[E];if(p)for(;F--&&!(s=o(c[F],G,n,p,q,r)););else if(!(s=o(c[E],G,n,p,q,r)))break}}else forIn(d,function(a,b,d){return hasOwnProperty.call(d,b)?(E++,s=hasOwnProperty.call(c,b)&&o(c[b],a,n,p,q,r)):void 0}),s&&!p&&forIn(c,function(a,b,c){return hasOwnProperty.call(c,b)?s=--E>-1:void 0});return q.pop(),r.pop(),C&&(b(q),b(r)),s}}}(),a.data=a.data||{},a.data.inspector=function(){function a(a){this.data=a||{}}return a.prototype.get=function(a,b){for(var c=a.split(b||"."),d="",e=0,f=c.length,g=this.data;f>e&&(d=c[e],g=g[d],void 0!==g);)e+=1;return g},a.prototype.set=function(a,b,c,d){for(var e=a.split(c||"."),f="",g=0,h=e.length-1,i=this.data;h>g;)f=e[g],f&&(i=void 0===i[f]||null===i[f]?i[f]={}:i[f]),g+=1;if(e.length>1){var j=e.pop();i[j]&&d?angular.extend(i[j],b):i[j]=b}return this.data},a.prototype.path=function(a){return this.set(a,{})},function(b){return new a(b)}}(),a.data=a.data||{},a.data.diff=function(b,c){var d,e={};b=b||{};for(var f in c)if(f in b)if(n.isDate(c[f]))d=n.isDate(b[f])?b[f].toISOString():b[f],c[f].toISOString()!==d&&(e[f]=c[f]);else if(n.isObject(c[f])&&!n.isArray(c[f])){var g=a.data.diff(b[f],c[f]);n.isEmpty(g)||(e[f]=g)}else n.isEqual(b[f],c[f])||(e[f]=c[f]);else e[f]=c[f];return n.isEmpty(e)?null:e};var o=function(){function b(b){var d=b.uid.split(".").length,e=a.util.array.toArray(arguments),f=c("	",d)+b.uid+":"+b.type+":"+b.status+":"+b.state+":"+b.progress+"::";e.shift(),e[0]=f+e[0],console.log.apply(console,e)}function c(a,b){for(var c="";c.length<b;)c+=a;return c}var d={};return d.log=b,d}(),p={ROOT:"root",STEP:"step",VAR:"var",FIND:"find",FIND_TEXT:"findText",FIND_VAL:"findVal",ASSERT:"assert",EXPECT:"expect",IF:"if",ELSEIF:"elseif",ELSE:"else",AJAX:"ajax",PATH:"path",PAGE:"page",SOCKET:"socket"},q={UNRESOLVED:"unresolved",FAIL:"fail",PASS:"pass",TIMED_OUT:"timedOut",SKIP:"skip"},r={WAITING:"waiting",ENTERING:"entering",RUNNING:"running",COMPLETE:"complete"},s=m.events,t={root:{},step:{label:"",type:"step",status:q.UNRESOLVED,state:r.WAITING,childIndex:-1,skipCount:0,startTime:0,endTime:0,time:0,increment:50,expectedTime:100,maxTime:2e3,progress:0,data:void 0,payload:void 0},"var":{maxTime:200},assert:{maxTime:1e3},expect:{maxTime:1e3},find:{maxTime:1e4},findVal:{maxTime:1e3},findText:{maxTime:1e3},"if":{increment:10,expectedTime:50,maxTime:500},elseif:{increment:10,expectedTime:50,maxTime:500},"else":{increment:10,expectedTime:50,maxTime:500},ajax:{expectedTime:600,maxTime:6e4},path:{expectedTime:1e3,maxTime:1e4},page:{expectedTime:2e3,maxTime:3e4},socked:{expectedTime:1e3,maxTime:1e4}},u={$$hashKey:!0,element:!0},v={$$hashKey:!0,uid:!0,index:!0,state:!0,status:!0,progress:!0,time:!0,startTime:!0,endTime:!0};i.prototype[p.STEP]=function(){return q.PASS},i.prototype[p.ROOT]=i.prototype[p.STEP],i.prototype[p.IF]=function(a){return a.override||q.PASS},i.prototype[p.ELSEIF]=function(a){return a.override||q.PASS},i.prototype[p.ELSE]=function(a){return a.override||q.PASS};i.prototype[p.ASSERT]=function(){var a=!0;return a?q.PASS:q.FAIL},i.prototype[p.EXPECT]=function(a){var b=m.getLastStep();return b.payload===a.data?q.PASS:q.FAIL},i.prototype[p.FIND]=function(b){if(!b.data||"string"!=typeof b.data)throw new Error("Invalid selector for step of type "+b.type);var c=a.selector.query(b.data);return b.element=c&&c[0],b.payload=c.length,b.element?q.PASS:q.FAIL},i.prototype[p.FIND+"Val"]=function(a){var b=m.getLastStep();return a.element=b.element,a.payload=a.element.value,q.PASS},i.prototype[p.FIND+"Text"]=function(a){var b=m.getLastStep();return a.element=b.element,a.payload=a.element.innerText,q.PASS},l(m),a.selector=function(){function b(a,b){b=b||z.config.doc.body;var c,d,e=/:eq\((\d+)\)$/,f=a.match(e);return f&&f.length&&(a=a.replace(e,""),d=f[1]),c=b.querySelectorAll(a),c&&void 0!==d?c[d]:c}function c(c,d){if(e(c)){for(var g,i,k,l=j(d),m=z.config.doc.body,n=h(c,m,l,null,!0);n.count>n.totalCount;)n=n.parent;if(n=n.parent||n,k=n.str||q(n),n.str)for(var o=n.child;o;)k+=" "+o.str,o=o.child;return(n.count>1||n.child&&n.child.count)&&(g=a.util.array.toArray(b(k,m)),i=g.indexOf(c),k+=":eq("+i+")"),k+=f()}return""}function d(a,b,c){if(e(a)){var d=j(c),g=h(a,b,d);return q(g)+f()}return""}function e(a){if(!a)return"";if(a&&a.length)throw new Error("selector can only build a selection to a single DOMElement. A list was passed.");return!0}function f(){return z.config.addVisible?":visible":""}function g(a,b){return"string"==typeof b&&b===a?!0:"object"==typeof b&&a.match(b)?!0:!1}function h(a,b,c,d,e){var f;return a?(b=b||z.config.doc,f={element:a,ignoreClass:c,maxParent:b,classes:k(a,c),attributes:l(a,d),type:a.nodeName&&a.nodeName.toLowerCase()||"",child:d},(!f.attributes.$unique||d)&&(e?(f.str=q(f,0,null,!0),f.count=b.querySelectorAll(f.str).length,f.count>1&&(f.parent=s(a,b,c,f,e))):f.parent=s(a,b,c,f,e)),f):""}function i(a){return"number"!=typeof a}function j(a){return a=a||[],"function"==typeof a?a:function(b){if(a instanceof Array)for(var c=0,d=a.length;d>c;){if(g(b,a[c]))return!1;c+=1}else if(g(b,a))return!1;return!0}}function k(a,b){var c=ux.filter(a.classList,i);return c=ux.filter(c,y),ux.filter(c,b)}function l(a){var b,c=0,d=a.attributes?a.attributes.length:0,e=[],f=n(a.attributes);if(f&&("id"===f.name&&z.config.allowId?e.push("#"+f.value):"id"!==f.name&&e.push(m(f)),e.length))return e.$unique=!0,e;if(z.config.allowAttributes)for(;d>c;)b=a.attributes[c],v[b.name]||w[b.name]||e.push(m(b)),c+=1;return e}function m(a){return"["+o(a.name)+"='"+p(a.value)+"']"}function n(a){for(var b,c,d=0,e=a?a.length:0;e>d;){if(b=a[d],c=o(b.name),w[c])return b;d+=1}return null}function o(a){var b,c,d=1;if(a.indexOf("-")){for(b=a.split("-"),c=b.length;c>d;)b[d]=b[d].charAt(0).toUpperCase()+b[d].substr(1),d+=1;a=b.join("")}return a}function p(a){return a.replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function q(a,b,c,d){var e,f,g;return b=b||0,f=a&&!a.attributes.$unique?q(a.parent,b+1):"",a&&(f+=(f.length?" ":"")+r(a)),b||d||(g=c||a.maxParent,e=g.querySelectorAll&&g.querySelectorAll(f)||[],e.length>1&&(f+=":eq("+t(e,a.element)+")")),f}function r(a){return a.attributes.$unique?a.attributes[0]:a.type+a.attributes.join("")+(a.classes.length?"."+a.classes.join("."):"")}function s(a,b,c,d,e){var f=a.parentNode;return f&&f!==b?h(a.parentNode,b,c,d,e):null}function t(a,b){var c,d=a.length;for(c=0;d>c;c+=1)if(b===a[c])return c;return-1}function u(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}var v,w,x,y,z;return z={config:{doc:window.document,allowId:!0,allowAttributes:!0,addVisible:!1},addOmitAttrs:function(){return a.each(arguments,function(a){v[a]=!0}),this},removeOmitAttrs:function(){return a.each(arguments,function(a){delete v[a]}),this},getOmitAttrs:function(){return u(v)},resetOmitAttrs:function(){v={"class":!0,style:!0}},addUniqueAttrs:function(){return a.each(arguments,function(a){w[a]=!0}),this},removeUniqueAttrs:function(){return a.each(arguments,function(a){delete w[a]}),this},getUniqueAttrs:function(){return u(w)},resetUniqueAttrs:function(){w={id:!0,uid:!0}},addClassOmitFilters:function(){return a.each(arguments,function(a){x.push(a)}),y=j(x),this},removeClassOmitFilters:function(){return a.each(arguments,function(a){var b=x.indexOf(a);-1!==b&&x.splice(b,1)}),y=j(x),this},getClassOmitFilters:function(){return x.slice(0)},resetClassOmitFilters:function(){x=[],y=j(x)},query:b,get:c,getCleanSelector:c,quickSelector:d,reset:function(){z.resetOmitAttrs(),z.resetUniqueAttrs(),z.resetClassOmitFilters()}},z.reset(),z}()}(this.go=this.go||{},function(){return this}());